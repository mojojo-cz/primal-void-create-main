<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨å±€å†²çªæ£€æµ‹ä¿®å¤éªŒè¯</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            border-left: 4px solid;
        }
        .success {
            background-color: #d4edda;
            border-color: #28a745;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }
        .warning {
            background-color: #fff3cd;
            border-color: #ffc107;
            color: #856404;
        }
        .info {
            background-color: #d1ecf1;
            border-color: #17a2b8;
            color: #0c5460;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .test-step {
            margin: 15px 0;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .conflict-example {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: bold;
        }
        .code {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            border: 1px solid #e9ecef;
            overflow-x: auto;
        }
        h1 { color: #333; }
        h2 { color: #555; border-bottom: 2px solid #007bff; padding-bottom: 10px; }
        h3 { color: #666; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ å…¨å±€å†²çªæ£€æµ‹ä¿®å¤éªŒè¯</h1>
        
        <div class="status success">
            <h3>âœ… é—®é¢˜å·²ä¿®å¤</h3>
            <p>å‘ç°å¹¶ä¿®å¤äº†å…¨å±€å†²çªæ£€æµ‹ä¸å·¥ä½œçš„æ ¹æœ¬åŸå› ï¼šæ•°æ®åº“å‡½æ•°åç§°ä¸åŒ¹é…</p>
        </div>

        <div class="test-section">
            <h2>ğŸ¯ é—®é¢˜è¯Šæ–­ç»“æœ</h2>
            
            <div class="status error">
                <h3>âŒ åŸå§‹é—®é¢˜</h3>
                <p><strong>å‡½æ•°åä¸åŒ¹é…ï¼š</strong></p>
                <ul>
                    <li>æ•°æ®åº“ä¸­çš„å‡½æ•°ï¼š<code>check_schedule_conflict</code>ï¼ˆå•æ•°ï¼‰</li>
                    <li>å‰ç«¯è°ƒç”¨çš„å‡½æ•°ï¼š<code>check_schedule_conflicts</code>ï¼ˆå¤æ•°ï¼‰</li>
                    <li>ç»“æœï¼šRPCè°ƒç”¨å¤±è´¥ï¼Œå…¨å±€å†²çªæ£€æµ‹å®Œå…¨ä¸å·¥ä½œ</li>
                </ul>
            </div>

            <div class="status success">
                <h3>âœ… ä¿®å¤æ–¹æ¡ˆ</h3>
                <p>åˆ›å»ºäº†æ–°çš„æ•°æ®åº“å‡½æ•° <code>check_schedule_conflicts</code>ï¼Œè¿”å›å‰ç«¯æœŸæœ›çš„JSONæ ¼å¼ï¼š</p>
                <div class="code">
{
  "teacher_conflict": {
    "schedule_id": "uuid",
    "lesson_title": "å†²çªè¯¾ç¨‹åç§°",
    "plan_name": "æ‰€å±è¯¾è¡¨åç§°"
  },
  "venue_conflict": {
    "schedule_id": "uuid", 
    "lesson_title": "å†²çªè¯¾ç¨‹åç§°",
    "plan_name": "æ‰€å±è¯¾è¡¨åç§°"
  }
}
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ§ª æ‚¨æåˆ°çš„å†²çªæ¡ˆä¾‹</h2>
            
            <div class="conflict-example">
                âš ï¸ æ—¶é—´å†²çªæ¡ˆä¾‹ï¼š
                <br>â€¢ è¯¾ç¨‹A: 15:00-15:30 çº¿æ€§ä»£æ•° (leeè€å¸ˆ)
                <br>â€¢ è¯¾ç¨‹B: 15:15-15:30 çº¿æ€§ä»£æ•° (leeè€å¸ˆ)
                <br>é‡å æ—¶é—´ï¼š15:15-15:30 (15åˆ†é’Ÿ)
            </div>

            <div class="status info">
                <h3>ğŸ” å†²çªæ£€æµ‹é€»è¾‘éªŒè¯</h3>
                <p><strong>å‰ç«¯é¢„è§ˆåˆ—è¡¨æ£€æµ‹ï¼š</strong></p>
                <div class="code">
const isOverlapping = 
  schedule.schedule_date === otherSchedule.schedule_date &&
  schedule.end_time > otherSchedule.start_time &&
  schedule.start_time < otherSchedule.end_time;

// æ‚¨çš„æ¡ˆä¾‹ï¼š
// '15:30' > '15:15' âœ“ true
// '15:00' < '15:30' âœ“ true  
// â†’ isOverlapping = true âœ“ åº”è¯¥æ£€æµ‹åˆ°å†²çª
                </div>

                <p><strong>æ•°æ®åº“å…¨å±€æ£€æµ‹ï¼š</strong></p>
                <div class="code">
AND (s.start_time, s.end_time) OVERLAPS (p_start_time, p_end_time)

// PostgreSQL OVERLAPS æµ‹è¯•ï¼š
// ('15:00:00', '15:30:00') OVERLAPS ('15:15:00', '15:30:00') = true âœ“
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ“‹ ç°åœ¨è¯·æµ‹è¯•éªŒè¯</h2>
            
            <div class="test-step">
                <h3>1ï¸âƒ£ æ‰“å¼€æ™ºèƒ½æ’è¯¾å·¥ä½œå°</h3>
                <p>è¿›å…¥ç³»ç»Ÿ â†’ ç®¡ç†å‘˜é¢æ¿ â†’ æ’è¯¾ç®¡ç† â†’ æ™ºèƒ½æ’è¯¾å·¥ä½œå°</p>
            </div>

            <div class="test-step">
                <h3>2ï¸âƒ£ åˆ›å»ºå†²çªè¯¾ç¨‹</h3>
                <p><strong>é‡è¦ï¼šç¡®ä¿é€‰æ‹©åŒä¸€ä¸ªæ•™å¸ˆ</strong></p>
                <ul>
                    <li>è¯¾ç¨‹Aï¼š15:00-15:30ï¼Œé€‰æ‹©ä»»æ„æ•™å¸ˆï¼ˆå¦‚ leeï¼‰</li>
                    <li>è¯¾ç¨‹Bï¼š15:15-15:30ï¼Œé€‰æ‹©<strong>ç›¸åŒæ•™å¸ˆ</strong></li>
                </ul>
            </div>

            <div class="test-step">
                <h3>3ï¸âƒ£ è§‚å¯Ÿå†²çªè­¦å‘Š</h3>
                <p>åº”è¯¥çœ‹åˆ°ä»¥ä¸‹æ•ˆæœï¼š</p>
                <ul>
                    <li>ğŸ”´ é¢„è§ˆåˆ—è¡¨ä¸­çš„è¯¾ç¨‹æ˜¾ç¤ºçº¢è‰²è­¦å‘Šå›¾æ ‡ âš ï¸</li>
                    <li>ğŸ”´ è¯¾ç¨‹å¡ç‰‡èƒŒæ™¯å˜ä¸ºçº¢è‰²</li>
                    <li>ğŸ”´ ä¿å­˜æŒ‰é’®å˜ä¸ºçº¢è‰²å¹¶æ˜¾ç¤º"å­˜åœ¨å†²çªï¼Œæ— æ³•ä¿å­˜"</li>
                    <li>ğŸ”´ é¼ æ ‡æ‚¬åœåœ¨è­¦å‘Šå›¾æ ‡ä¸Šæ˜¾ç¤ºå†²çªè¯¦æƒ…</li>
                </ul>
            </div>

            <div class="test-step">
                <h3>4ï¸âƒ£ æµ‹è¯•æ•™å®¤å†²çª</h3>
                <p>åŒæ ·çš„æ­¥éª¤ï¼Œä½†é€‰æ‹©ï¼š</p>
                <ul>
                    <li>ä¸åŒæ•™å¸ˆï¼Œä½†<strong>ç›¸åŒæ•™å®¤</strong></li>
                    <li>åº”è¯¥çœ‹åˆ°æ•™å®¤å†²çªè­¦å‘Š</li>
                </ul>
            </div>
        </div>

        <div class="test-section">
            <h2>ğŸ›¡ï¸ å…¨å±€å†²çªæ£€æµ‹è¦†ç›–èŒƒå›´</h2>
            
            <div class="status info">
                <p><strong>ç°åœ¨å¯ä»¥æ£€æµ‹çš„å†²çªç±»å‹ï¼š</strong></p>
                <ul>
                    <li>âœ… åŒä¸€æ•™å¸ˆåœ¨ç›¸åŒæ—¶é—´æ®µçš„å†²çª</li>
                    <li>âœ… åŒä¸€æ•™å®¤åœ¨ç›¸åŒæ—¶é—´æ®µçš„å†²çª</li>
                    <li>âœ… è·¨è¯¾è¡¨çš„å…¨å±€å†²çªæ£€æµ‹</li>
                    <li>âœ… é¢„è§ˆåˆ—è¡¨å†…éƒ¨çš„å†²çªæ£€æµ‹</li>
                    <li>âœ… éƒ¨åˆ†æ—¶é—´é‡å æ£€æµ‹ï¼ˆå¦‚æ‚¨çš„æ¡ˆä¾‹ï¼‰</li>
                    <li>âœ… è¾¹ç•Œæ—¶é—´æ£€æµ‹ï¼ˆ9:00-10:00 vs 10:00-11:00 = æ— å†²çªï¼‰</li>
                </ul>
            </div>
        </div>

        <div class="status warning">
            <h3>ğŸ’¡ å¦‚æœä»ç„¶æ²¡æœ‰çœ‹åˆ°å†²çªè­¦å‘Š</h3>
            <p>è¯·æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
            <ol>
                <li><strong>æ•™å¸ˆ/æ•™å®¤å¿…é¡»ç›¸åŒï¼š</strong>å†²çªæ£€æµ‹åªåœ¨ç›¸åŒèµ„æºæ—¶è§¦å‘</li>
                <li><strong>ç­‰å¾…å¼‚æ­¥æ£€æµ‹ï¼š</strong>å†²çªæ£€æµ‹åœ¨åå°å¼‚æ­¥æ‰§è¡Œï¼Œå¯èƒ½éœ€è¦1-2ç§’</li>
                <li><strong>æ£€æŸ¥æ§åˆ¶å°é”™è¯¯ï¼š</strong>æ‰“å¼€å¼€å‘è€…å·¥å…·æŸ¥çœ‹æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯</li>
                <li><strong>æ—¥æœŸå¿…é¡»ç›¸åŒï¼š</strong>ç¡®ä¿ä¸¤ä¸ªè¯¾ç¨‹åœ¨åŒä¸€å¤©</li>
            </ol>
        </div>

        <div class="status success">
            <h3>ğŸ‰ ä¿®å¤æ€»ç»“</h3>
            <p>
                é€šè¿‡åˆ›å»ºæ­£ç¡®çš„æ•°æ®åº“å‡½æ•° <code>check_schedule_conflicts</code>ï¼Œ
                å…¨å±€å†²çªæ£€æµ‹ç°åœ¨åº”è¯¥èƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼ŒåŒ…æ‹¬æ‚¨æåˆ°çš„ 
                <strong>15:00-15:30 vs 15:15-15:30</strong> è¿™æ ·çš„éƒ¨åˆ†æ—¶é—´é‡å æ¡ˆä¾‹ã€‚
            </p>
        </div>
    </div>
</body>
</html> 